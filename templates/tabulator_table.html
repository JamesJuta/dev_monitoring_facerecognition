<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Database Table Display</title>

    <!-- Include Tabulator CSS and JS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link href='https://unpkg.com/boxicons@2.1.1/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/tabulator_bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/tabulator.min.css') }}">
    <link rel="stylesheet" href="https://unpkg.com/tabulator-tables@5.1.5/dist/css/tabulator.min.css">
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables@5.1.5/dist/js/tabulator.min.js"></script>
    <script src="{{ url_for('static', filename='js/tabulator.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/jquery.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>

    <!-- Include date range picker -->
    <!-- <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker@3.1.0/daterangepicker.css" />
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker@3.1.0/moment.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker@3.1.0/daterangepicker.js"></script>

    <script src="{{ url_for('static', filename='js/bootstrap-datetimepicker.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/daterangepicker.js') }}"></script> -->

    <style>
        /* Include your custom CSS styles here */
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        .custom-tabulator {
            border: 1px solid #ddd;
            background-color: #f9f9f9;
            font-family: 'Poppins', sans-serif;
        }

        .custom-tabulator .tabulator-header {
            background-color: #ffffff;
            color: black;
        }
        .custom-tabulator .tabulator-footer {
            background-color: #ffffff;
            color: black;
        }

        .custom-tabulator .tabulator-row {
            background-color: #fff;
        }

        /* .custom-tabulator .tabulator-row:nth-child(even) {
            background-color: #f2f2f2;
        } */

        .custom-tabulator .tabulator-cell {
            padding: 10px;
        }

        .custom-tabulator .tabulator-cell {
            padding: 10px;
        }

      
    </style>
</head>
<body>

     <nav>

        <div class="logocontainer">
            <!-- <img src="img/logo.png" class="logopic" alt=""> -->
            <i class='scanner bx bx-scan'></i>
            E-<strong>Monitoring</strong>
        </div>
        <input id="nav-toggle" type="checkbox">

        <!-- nav links -->
        <ul class="links">
            <li><a href="">Home</a></li>
            <li><a class="active" href="">Time Log</a></li>
            <li><a href="">Face Register</a></li>
        </ul>

        <!-- burger icon -->
        <label for="nav-toggle" class="icon-burger">
            <div class="line"></div>
            <div class="line"></div>
            <div class="line"></div>
        </label>

        <!-- search icon -->
        <!-- <div class="search-box">
                <input class="search-txt" type="text" name="" placeholder="Type to search">
                <a class="search-btn" href="#"><i class="fas fa-search"></i></a>
            </div> -->

        <!-- <a href="">button</a> -->

    </nav>


    <div class="container">
        <div class="row" style="padding: 20px 80px;">
            <div class="col-12">
                <div class="data_table">
                    <div class="container_header">
                        <i class='scan bx bx-time'></i>
                        <strong>Today Scan</strong>
                        <!-- Include a search input for the date range picker -->
                        <input type="text" id="dateRangePicker" />


                        <div class="form-group float-end mb-2" style="margin-left:auto;" id="DateDemo">
                            <label for="exampleDataList" class="form-label"><b>Filter by</b></label>
                            <input type="text" id="date_range" name="date_range" class="form-control  " style="width:300px;" value="<?php echo DATE_NOW; ?>" placeholder="Select Date">
                        </div>


                    </div>
                    
                    <div id="time-log-table" class="table tabulator custom-tabulator"></div>
                    <div>
                        <button type="button" class="table_btn" id="user-download-csv">Download CSV</button>
                        <button type="button" class="table_btn" id="user-download-xlsx">Download XLSX</button>
                        <button type="button" class="table_btn" id="user-print-table">Print</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer>Â© 2023 - 2024 City College of Calamba</footer>

    <script>
        // Initialize Tabulator with your data
        // Initialize date range picker
        $('#dateRangePicker').daterangepicker();

        const table = new Tabulator("#time-log-table", {
            height: "400px",
            printAsHtml: true,
            headerFilterPlaceholder: "Search",
            layout: "fitDataStretch",
            placeholder: "No Data Found",
            placeholderHeaderFilter:"No Matching Data",
            movableColumns: true,
            selectable: true,
            selectableRollingSelection: false,
            headerHozAlign: 'center',
            pagination:true,
            paginationSize:20,
            paginationSizeSelector: [100, 500, 1000, true],
            
            data: {{ data|tojson|safe }},
            columns: [
                {title: "Date", field: "date", 
                    headerFilter: "input",
                    headerFilterFunc: "like",
                    headerFilterParams: {
                        allowEmpty: true
                    },
                    headerFilterLiveFilter: false,
                    formatter: 'textarea',
                    vertAlign: 'middle',
                    minWidth: 190},
                {title: "Time", field: "time", 
                    headerFilter: "input",
                    headerFilterFunc: "like",
                    headerFilterParams: {
                        allowEmpty: true
                    },
                    headerFilterLiveFilter: false,
                    formatter: 'textarea',
                    vertAlign: 'middle',
                    minWidth: 190},
                {title: "Name", field: "name", 
                    headerFilter: "input",
                    headerFilterFunc: "like",
                    headerFilterParams: {
                        allowEmpty: true
                    },
                    headerFilterLiveFilter: false,
                    formatter: 'textarea',
                    vertAlign: 'middle',
                    minWidth: 179},
                {title: "Building Name", field: "building_name", 
                    headerFilter: "input",
                    headerFilterFunc: "like",
                    headerFilterParams: {
                        allowEmpty: true
                    },
                    headerFilterLiveFilter: false,
                    formatter: 'textarea',
                    vertAlign: 'middle',
                        minWidth: 190},
            ],
        });

        // Listen for changes in the date range picker
        $('#dateRangePicker').on('apply.daterangepicker', function (ev, picker) {
            // Get the selected date range
            var startDate = picker.startDate.format('YYYY-MM-DD');
            var endDate = picker.endDate.format('YYYY-MM-DD');

            // Apply the filter to the Tabulator table
            table.setFilter([
                { field: "date", type: ">=", value: startDate },
                { field: "date", type: "<=", value: endDate }
            ]);
        });

        addListener(document.getElementById('user-download-csv'), "click", function() {
            table.download("csv", "user_information_.csv", {
                bom: true
            });
        });

        addListener(document.getElementById('user-download-xlsx'), "click", function() {
            table.download("xlsx", "user_information_.xlsx");
        });

        addListener(document.getElementById('user-print-table'), "click", function() {
            table.print(false, true);
        });

        
    </script>  
    
    
    

</body>
</html>
